/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package Inventori.gui;

import Inventori.Items;
import Inventori.Satuan;
import Inventori.StokItem;
import Util.BackgroundImage;
import Util.BackgroundPane;
import Util.DBConnector;
import java.awt.BorderLayout;
import java.awt.Toolkit;
import java.io.File;
import java.io.IOException;
import java.sql.SQLException;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.imageio.ImageIO;
import javax.swing.JOptionPane;

/**
 *
 * @author Yestin
 */
public class EditHarga extends javax.swing.JDialog {

    Items Item = new Items();
    StokItem StokItem = new StokItem();
    Satuan Sat = new Satuan();
    BackgroundImage BI = new BackgroundImage();
    /**
     * Creates new form EditHarga
     */
    public EditHarga(java.awt.Frame parent, boolean modal) {
        super(parent, modal);
        initComponents();
        setTitle("Edit Harga");
        BI.BackgroundJPanel(this, pnlEditHarga);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        pnlEditHarga = new javax.swing.JPanel();
        lblBarcode = new javax.swing.JLabel();
        txtBarcode = new javax.swing.JTextField();
        jLabel1 = new javax.swing.JLabel();
        txtNamaItem = new javax.swing.JTextField();
        jLabel2 = new javax.swing.JLabel();
        txtSatuan = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        ftxtHargaModal = new javax.swing.JFormattedTextField();
        lblHargaJual = new javax.swing.JLabel();
        ftxtHargaJual = new javax.swing.JFormattedTextField();
        jLabel4 = new javax.swing.JLabel();
        ftxtDiskon = new javax.swing.JFormattedTextField();
        btnSimpan = new javax.swing.JButton();
        btnTutup = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);

        lblBarcode.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N
        lblBarcode.setForeground(new java.awt.Color(0, 0, 255));
        lblBarcode.setText("Barcode :");

        txtBarcode.setEditable(false);
        txtBarcode.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N
        txtBarcode.setForeground(new java.awt.Color(0, 0, 255));

        jLabel1.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N
        jLabel1.setForeground(new java.awt.Color(0, 0, 255));
        jLabel1.setText("Nama Item :");

        txtNamaItem.setEditable(false);
        txtNamaItem.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N
        txtNamaItem.setForeground(new java.awt.Color(0, 0, 255));

        jLabel2.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N
        jLabel2.setForeground(new java.awt.Color(0, 0, 255));
        jLabel2.setText("Satuan :");

        txtSatuan.setEditable(false);
        txtSatuan.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N
        txtSatuan.setForeground(new java.awt.Color(0, 0, 255));

        jLabel3.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N
        jLabel3.setForeground(new java.awt.Color(0, 0, 255));
        jLabel3.setText("Harga Modal :");

        ftxtHargaModal.setForeground(new java.awt.Color(0, 0, 255));
        ftxtHargaModal.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N

        lblHargaJual.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N
        lblHargaJual.setForeground(new java.awt.Color(0, 0, 255));
        lblHargaJual.setText("Harga Jual :");

        ftxtHargaJual.setForeground(new java.awt.Color(0, 0, 255));
        ftxtHargaJual.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N

        jLabel4.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N
        jLabel4.setForeground(new java.awt.Color(0, 0, 255));
        jLabel4.setText("Diskon :");

        ftxtDiskon.setForeground(new java.awt.Color(0, 0, 255));
        ftxtDiskon.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N

        btnSimpan.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/Simpan2.png"))); // NOI18N
        btnSimpan.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSimpanActionPerformed(evt);
            }
        });

        btnTutup.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icon/Tutup.png"))); // NOI18N
        btnTutup.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnTutupActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout pnlEditHargaLayout = new javax.swing.GroupLayout(pnlEditHarga);
        pnlEditHarga.setLayout(pnlEditHargaLayout);
        pnlEditHargaLayout.setHorizontalGroup(
            pnlEditHargaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlEditHargaLayout.createSequentialGroup()
                .addGroup(pnlEditHargaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(pnlEditHargaLayout.createSequentialGroup()
                        .addGap(185, 185, 185)
                        .addComponent(btnSimpan)
                        .addGap(55, 55, 55)
                        .addComponent(btnTutup))
                    .addGroup(pnlEditHargaLayout.createSequentialGroup()
                        .addGap(53, 53, 53)
                        .addGroup(pnlEditHargaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(lblBarcode)
                            .addComponent(jLabel1)
                            .addComponent(jLabel2)
                            .addComponent(jLabel3)
                            .addComponent(lblHargaJual)
                            .addComponent(jLabel4))
                        .addGap(30, 30, 30)
                        .addGroup(pnlEditHargaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(txtBarcode)
                            .addComponent(txtNamaItem)
                            .addComponent(txtSatuan)
                            .addComponent(ftxtHargaModal)
                            .addComponent(ftxtHargaJual)
                            .addComponent(ftxtDiskon, javax.swing.GroupLayout.DEFAULT_SIZE, 504, Short.MAX_VALUE))))
                .addContainerGap(39, Short.MAX_VALUE))
        );
        pnlEditHargaLayout.setVerticalGroup(
            pnlEditHargaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlEditHargaLayout.createSequentialGroup()
                .addGap(55, 55, 55)
                .addGroup(pnlEditHargaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblBarcode)
                    .addComponent(txtBarcode, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(pnlEditHargaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel1)
                    .addComponent(txtNamaItem, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(pnlEditHargaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel2)
                    .addComponent(txtSatuan, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(pnlEditHargaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel3)
                    .addComponent(ftxtHargaModal, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(pnlEditHargaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblHargaJual)
                    .addComponent(ftxtHargaJual, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(pnlEditHargaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel4)
                    .addComponent(ftxtDiskon, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 104, Short.MAX_VALUE)
                .addGroup(pnlEditHargaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(btnSimpan)
                    .addComponent(btnTutup))
                .addGap(39, 39, 39))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addComponent(pnlEditHarga, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(pnlEditHarga, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void btnSimpanActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSimpanActionPerformed
        // TODO add your handling code here:
        if(ftxtHargaModal.getText().trim().length()==0){
            JOptionPane.showMessageDialog(this, "Harga Modal Belum Diisi");
            return;
        }
        if(ftxtHargaJual.getText().trim().length()==0){
            JOptionPane.showMessageDialog(this, "Harga Jual Belum Diisi");
            return;
        }
        
        String Barcode = (((String)txtBarcode.getText().trim()).toString());
        String NamaSatuan = (((String)txtSatuan.getText().trim()).toString());
        int KodeSatuan = Sat.getKodeSatuan(NamaSatuan);
        
        try {
            if(ftxtHargaModal.getValue() instanceof Long){
                Double HargaModal = (((Long)ftxtHargaModal.getValue()).doubleValue());
                StokItem.UpdateHargaModal(Barcode, KodeSatuan, HargaModal);
            }
            else if(ftxtHargaModal.getValue() instanceof Long){
                Double HargaModal = (((Double)ftxtHargaModal.getValue()).doubleValue());
                StokItem.UpdateHargaModal(Barcode, KodeSatuan, HargaModal);
            }
            if(ftxtHargaJual.getValue() instanceof Long){
                Double HargaJual = (((Long)ftxtHargaJual.getValue()).doubleValue());
                StokItem.UpdateHargaJual(Barcode, KodeSatuan, HargaJual);
            }
            else if(ftxtHargaJual.getValue() instanceof Double){
                Double HargaJual = (((Double)ftxtHargaJual.getValue()).doubleValue());
                StokItem.UpdateHargaJual(Barcode, KodeSatuan, HargaJual);
            }
            if(ftxtDiskon.getValue() instanceof Long){
                Double Diskon = (((Long)ftxtDiskon.getValue()).doubleValue());
                StokItem.UpdateDiskon(Barcode, KodeSatuan, Diskon);
            }
            else if(ftxtDiskon.getValue() instanceof Double){
                Double Diskon = (((Double)ftxtDiskon.getValue()).doubleValue());
                StokItem.UpdateDiskon(Barcode, KodeSatuan, Diskon);
            }
            
            DBConnector.getConnection().commit();
            Toolkit.getDefaultToolkit().beep();
            JOptionPane.showMessageDialog(this, "Data Berhasil Diperbarui");
        } 
        catch (SQLException e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(this, "Error Saat Memperbarui Harga : "+e.getMessage(),
                    "Error",JOptionPane.ERROR_MESSAGE);
            return;
        }
    }//GEN-LAST:event_btnSimpanActionPerformed

    private void btnTutupActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnTutupActionPerformed
        // TODO add your handling code here:
        setVisible(false);
        dispose();
    }//GEN-LAST:event_btnTutupActionPerformed

    /**
     * @param args the command line arguments
     */

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnSimpan;
    private javax.swing.JButton btnTutup;
    public javax.swing.JFormattedTextField ftxtDiskon;
    public javax.swing.JFormattedTextField ftxtHargaJual;
    public javax.swing.JFormattedTextField ftxtHargaModal;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel lblBarcode;
    private javax.swing.JLabel lblHargaJual;
    private javax.swing.JPanel pnlEditHarga;
    public javax.swing.JTextField txtBarcode;
    public javax.swing.JTextField txtNamaItem;
    public javax.swing.JTextField txtSatuan;
    // End of variables declaration//GEN-END:variables
}
